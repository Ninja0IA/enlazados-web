<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>ENLAZADOS ‚Äî Panel de Administraci√≥n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="img/favicon.svg" type="image/svg+xml" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --bg: #ffffff;
      --fg: #1f2937;
      --muted: #6b7280;
      --primary: #1D4289;
      --primary-2: #69B3E7;
      --card: #ffffff;
      --border: #e5e7eb;

      /* Halloween (modo oscuro) */
      --bg-dark: #0a0a12;
      --card-dark: #1a0925;
      --fg-dark: #f2e9e4;
      --accent: #ff7518;   /* naranja */
      --accent-2: #9d4edd; /* morado */
      --border-dark: rgba(255,117,24,.35);
    }

    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; font-family:'Open Sans', system-ui, -apple-system, Segoe UI, Roboto, Arial; color:var(--fg); background:var(--bg); }

    header {
      position: sticky; top:0; z-index:10;
      background: #f8fafc;
      border-bottom:1px solid var(--border);
    }
    .modo-oscuro header {
      background: linear-gradient(180deg, #15061d 0%, #1a0925 100%) !important;
      border-bottom:1px solid var(--border-dark);
      color: var(--fg-dark);
      box-shadow: 0 2px 12px rgba(157,78,221,0.25);
    }

    .toolbar {
      display:flex; align-items:center; gap:16px; padding:14px 18px; max-width:1200px; margin:0 auto;
    }
    .brand { display:flex; align-items:center; gap:12px; }
    .brand h1 { font-family:'Playfair Display', serif; font-weight:700; letter-spacing:.5px; margin:0; }
    .brand small { color:var(--muted); display:block; margin-top:2px; }
    .modo-oscuro .brand h1 { color:#ffb703; text-shadow:0 0 8px rgba(157,78,221,.25); }
    .modo-oscuro .brand small { color:#ffb703; opacity:.9; }

    .spacer { flex:1 1 auto; }

    .btn {
      appearance:none; border:1px solid var(--border); background:#fff; color:var(--fg);
      padding:8px 12px; border-radius:10px; font-weight:600; cursor:pointer; transition:transform .12s ease, filter .12s ease;
    }
    .btn:hover { transform: translateY(-1px); filter: brightness(.98); }
    .btn.primary { border-color: transparent; background: var(--primary); color:#fff; }
    .btn.primary:hover { filter: brightness(1.05); }
    .modo-oscuro .btn { background: var(--card-dark); color: var(--fg-dark); border-color: var(--border-dark); }
    .modo-oscuro .btn.primary { background:#4c0070; border-color:#9d4edd; }

    .toggle-tema { margin-left: 8px; }

    main { max-width:1200px; margin: 18px auto 40px; padding: 0 18px; }

    /* Tarjetas */
    .cards { display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:18px; }
    .card {
      background: var(--card); border:1px solid var(--border); border-radius:14px; padding:16px;
      box-shadow: 0 2px 10px rgba(0,0,0,.04);
    }
    .modo-oscuro .card { background: var(--card-dark); color: var(--fg-dark); border-color: var(--border-dark); }

    .card h3 { margin:0 0 10px; font-size:1.1rem; }
    .stat { font-size:1.6rem; font-weight:700; }

    /* Secciones */
    section { margin-top: 22px; }
    .section-title { display:flex; align-items:center; gap:10px; margin: 14px 0; }
    .section-title h2 { margin:0; font-size:1.2rem; }
    .section-actions { margin-left:auto; display:flex; gap:10px; }

    /* Formulario nueva/editar */
    .form-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:14px; }
    .form-group { display:flex; flex-direction:column; gap:6px; }
    label { font-weight:600; font-size:.92rem; }
    input[type="text"], input[type="number"], input[type="url"], textarea, select {
      width:100%; padding:10px 12px; border:1px solid var(--border); border-radius:10px; background:#fff; color:var(--fg);
      font-size:.98rem;
    }
    textarea { min-height:160px; }
    .modo-oscuro input[type="text"], .modo-oscuro input[type="number"], .modo-oscuro input[type="url"], .modo-oscuro textarea, .modo-oscuro select {
      background:#10061a; color:#f2e9e4; border-color:var(--border-dark);
    }

    .chips { display:flex; flex-wrap:wrap; gap:8px; }
    .chip {
      background:#f1f5f9; border:1px solid var(--border); padding:6px 10px; border-radius:100px; font-size:.86rem;
    }
    .modo-oscuro .chip { background:#0f1120; border-color:var(--border-dark); color:#f2e9e4; }

    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .row .grow { flex:1 1 auto; }
    .checkbox { display:flex; align-items:center; gap:8px; margin-top:8px; }

    /* Lista de notas */
    .table { width:100%; border-collapse: collapse; }
    .table th, .table td { padding:10px 12px; border-bottom:1px solid var(--border); text-align:left; font-size:.96rem; }
    .modo-oscuro .table th, .modo-oscuro .table td { border-color:var(--border-dark); }
    .badge { display:inline-block; padding:4px 8px; border-radius:8px; font-size:.8rem; font-weight:700; }
    .ok { background:#10b98122; color:#065f46; }
    .warn { background:#f59e0b22; color:#92400e; }
    .err { background:#ef444422; color:#7f1d1d; }
    .modo-oscuro .ok { background:rgba(16,185,129,.15); color:#a7f3d0; }
    .modo-oscuro .warn { background:rgba(245,158,11,.15); color:#fde68a; }
    .modo-oscuro .err { background:rgba(239,68,68,.15); color:#fecaca; }

    /* Carrusel de sugerencias de relacionadas (chips seleccionables) */
    .rel-sugerencias { display:flex; gap:8px; overflow:auto; padding:6px 0; }
    .rel-chip { border:1px solid var(--border); border-radius:10px; padding:6px 10px; cursor:pointer; white-space:nowrap; }
    .rel-chip.activa { background:var(--primary); color:#fff; border-color:transparent; }
    .modo-oscuro .rel-chip { background:#10061a; border-color:var(--border-dark); color:#f2e9e4; }
    .modo-oscuro .rel-chip.activa { background:#4c0070; border-color:#9d4edd; }

    /* Notificaci√≥n sutil */
    .toast {
      position: fixed; right: 18px; bottom: 18px; z-index: 9999;
      background: #111827; color: #f9fafb; padding: 12px 14px; border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,.25); opacity:0; transform: translateY(8px); pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
    }
    .toast.show { opacity: 1; transform: translateY(0); }
    .modo-oscuro .toast { background:#1a0925; border:1px solid var(--border-dark); }

    /* Footer */
    footer { text-align:center; color:var(--muted); padding:20px 0 40px; }
    .modo-oscuro footer { color:#ffb703; opacity:.85; }
  </style>
</head>
<body>
  <header>
    <div class="toolbar">
      <div class="brand">
        <img src="img/Logo.jpg" alt="ENLAZADOS" style="width:40px;height:40px;border-radius:8px;object-fit:cover;">
        <div>
          <h1>ENLAZADOS ‚Äî Admin</h1>
          <small id="frase-motivacional">‚ÄúCada palabra bien elegida ilumina a quien la lee.‚Äù</small>
        </div>
      </div>

      <div class="spacer"></div>

      <button id="btn-toggle-tema" class="btn toggle-tema" type="button" aria-pressed="false">üåô Modo oscuro</button>

      <div class="row">
        <button id="btn-login" class="btn primary" type="button">Iniciar sesi√≥n</button>
        <button id="btn-logout" class="btn" type="button" style="display:none;">Cerrar sesi√≥n</button>
        <span id="user-info" class="chip" style="display:none;">Conectado</span>
      </div>
    </div>
  </header>

  <main>
    <!-- Estad√≠sticas -->
    <section>
      <div class="section-title">
        <h2>Estad√≠sticas</h2>
        <div class="section-actions">
          <button id="btn-refrescar" class="btn">Refrescar</button>
        </div>
      </div>
      <div class="cards">
        <div class="card">
          <h3>Total de notas</h3>
          <div id="stat-total" class="stat">‚Äî</div>
        </div>
        <div class="card">
          <h3>Vistas acumuladas</h3>
          <div id="stat-vistas" class="stat">‚Äî</div>
        </div>
        <div class="card">
          <h3>M√°s le√≠da</h3>
          <div id="stat-top" class="stat" style="font-size:1rem;">‚Äî</div>
        </div>
      </div>
    </section>

    <!-- Nueva / Editar nota -->
    <section>
      <div class="section-title">
        <h2>Nueva nota / Editar</h2>
        <div class="section-actions">
          <button id="btn-nueva" class="btn">Iniciar una nueva historia ‚úçÔ∏è</button>
          <button id="btn-guardar" class="btn primary">Guardar</button>
          <button id="btn-borrar" class="btn">Borrar</button>
        </div>
      </div>

      <div class="card">
        <div class="form-grid">
          <input type="hidden" id="nota-id" />

          <div class="form-group">
            <label for="titulo">T√≠tulo</label>
            <input type="text" id="titulo" placeholder="Escribe un t√≠tulo claro y atractivo">
          </div>

          <div class="form-group">
            <label for="categoria">Categor√≠a</label>
            <input type="text" id="categoria" placeholder="Ej. Cultura, Educaci√≥n, Pol√≠tica‚Ä¶">
          </div>

          <div class="form-group">
            <label for="etiquetas">Etiquetas (separadas por coma)</label>
            <input type="text" id="etiquetas" placeholder="teatro, universidad, tampico">
          </div>

          <div class="form-group">
            <label for="prioridad">Prioridad (1 = m√°s alta)</label>
            <input type="number" id="prioridad" value="5" min="1" step="1">
          </div>

          <div class="form-group">
            <label for="imagen-url">Imagen principal (URL)</label>
            <input type="url" id="imagen-url" placeholder="https://‚Ä¶">
          </div>

          <div class="form-group">
            <label for="imagen-alt">Texto alternativo de la imagen</label>
            <input type="text" id="imagen-alt" placeholder="Descripci√≥n breve de la imagen">
          </div>

          <div class="form-group">
            <label for="es-visible">Visibilidad</label>
            <div class="checkbox">
              <input type="checkbox" id="es-visible" checked>
              <span>Mostrar p√∫blicamente</span>
            </div>
          </div>

          <div class="form-group" style="grid-column:1/-1;">
            <label for="cuerpo">Cuerpo (HTML permitido)</label>
            <textarea id="cuerpo" placeholder="Escribe el contenido de la nota..."></textarea>
          </div>

          <!-- Asistente de hipertexto -->
          <div class="form-group">
            <label>Insertar enlace a otra nota</label>
            <div class="row">
              <select id="select-hiper" class="grow"></select>
              <button id="btn-insertar-enlace" class="btn">Insertar enlace</button>
            </div>
            <small class="muted">Inserta <a>‚Ä¶</a> en el cursor del cuerpo.</small>
          </div>

          <!-- Notas relacionadas -->
          <div class="form-group" style="grid-column:1/-1;">
            <label>Notas relacionadas (m√°x. 5)</label>
            <div id="sugerencias-rel" class="rel-sugerencias"></div>
            <div class="chips" id="rel-seleccionadas"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Notas publicadas -->
    <section>
      <div class="section-title">
        <h2>Notas publicadas</h2>
        <div class="section-actions">
          <input type="text" id="buscar" placeholder="Buscar por t√≠tulo‚Ä¶" class="btn" style="min-width:240px;">
        </div>
      </div>

      <div class="card" style="overflow:auto;">
        <table class="table" id="tabla-notas">
          <thead>
            <tr>
              <th>T√≠tulo</th>
              <th>Categor√≠a</th>
              <th>Prioridad</th>
              <th>Vistas</th>
              <th>Visible</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tbody-notas"></tbody>
        </table>
      </div>
    </section>

    <!-- Diagn√≥stico -->
    <section>
      <div class="section-title">
        <h2>Diagn√≥stico</h2>
        <div class="section-actions"><button id="btn-diagnosticar" class="btn">Analizar</button></div>
      </div>
      <div class="card">
        <div id="diagnostico-lista">Ejecuta el an√°lisis para ver posibles problemas.</div>
      </div>
    </section>
  </main>

  <div id="toast" class="toast">Listo</div>

  <footer>
    <p>&copy; 2025 ENLAZADOS. Panel de administraci√≥n.</p>
  </footer>

  <script type="module" src="admin.js"></script>
</body>
</html>
